[Shock and Silence](https://tryhackme.com/room/shockandsilence) is a Data forensics room available on Tryhackme which focus on tracing the steps of a ransomware downloaded on the system. Data forensics is a new field for me, and the machine was a new entry so I thought "why not". Important to note is that this room is the fifth room in a series of rooms that can be found by looking up "Honeynet Collapse".

Regardless, some important info I was given:

    - All the resources that you need are on the user's Desktop:
    C:\Users\DFIR Analyst\Desktop
    - Disk image containing NTFS logs is located at:
    .\Artifacts\DC-01-NTFS-Logs.ad1
    - Analysis tools are located at: .\DFIR-Tools\*

Checking the `DFIR-Tool`folder gave me three tools:

- LogFileParser: A tool used to parse and create CSV's out of $LogFiles (I think).
- MFTECmd: A tool used to parse Master File Table entries.
- TimelineExplorer: Utility for viewing the CSV's generated by LogFileParser

My game plan is to generate the CSV's using LogFileParser, Get some info about whatever files I could find within the generated CSV's, including the ransomware. And finally, use TimelineExplorer to trace the ransomware's activity from start to finish.

(note: I had to move LogFileParser to the Public user folder as it kept complaining about not supporting path's with whitespace)

Let's start by launching Exterro FTK Imager. I will use this to extract any important files in the provided `.ad1` image. This includes the $MFT, $LogFile, and the root directory from the image.

![](./images/img1.png)

I Will first extract the $LogFile and send it to the parser. This process was taking a very long time so while that was being done, I also extracted the $MFT to create a CSV using MFTECmd to sniff out anything notable.

![](./images/img2.png)

I will then use TimelineExplorer to view the $MFT to look for anything interesting. Common sense is telling me to look into the downloads folder. I did just that and found a `HiddenFile` direcory which housed a pb.exe and a `README.EeUfy.txt`. Actually the README file was stored in every directory belonging to the user `matthew.collins`. Plus, there were a bunch of files with the extension `EeUfy`, further suggesting that pb.exe is our culprit.

![](./images/img3.png)

That answers Q2 and Q4. Now, let's check out the results of the $LogFile. 

![](./images/img4.png)

There are quite a few to say the least. but a quick search suggested that `ifusnjrnl` might be my best shot. As it stores a record of the changes made to every(?) file. Looking up `pb.exe` and scrolling up shows that the `HiddenFile` directory was actually extracted from a zip file downloaded using chrome.

![](./images/img5.png)

This is notable since the google chrome directory (stored in AppData) did not have ransom file extension (EeUfy). Though, I had no clue how I was 